<!--<elder-column-selector
  *ngIf="tableName"
  (columnUpdates)="(dataSource.displayedHeaders | async) = $event"
  [tableName]="tableName"
  (loaded)="selectorInitiated = true"
></elder-column-selector>-->
<ng-content select="[table-description]"></ng-content>

<div class="table-container soft-shadow-2">
  <div>
    Search Columns

    <input (input)="filterData($event)" />
  </div>
  <table
    cdk-table
    multiTemplateDataRows
    [dataSource]="dataSource"
    class="table"
    matSort
    [fixedLayout]="true"
  >
    <tr
      cdk-header-row
      class="header-row"
      *cdkHeaderRowDef="dataSource.displayedHeaders | async"
    ></tr>

    <tr
      cdk-row
      *cdkRowDef="
        let row;
        columns: dataSource.displayedHeaders | async;
        when: isShown
      "
      class="desktop"
    ></tr>
    <tr
      cdk-row
      *cdkRowDef="let row; columns: ['groupHeader']; when: isGroup"
      (click)="toggleGroup(row.term)"
    ></tr>
    <!--<tr
      cdk-row
      *cdkRowDef="let row; columns: ['mobileColumns']"
      class="mobile">
  </tr> -->

    <ng-container
      *ngFor="
        let field of dataSource.displayedHeaders | async;
        trackBy: trackByFn
      "
      cdkColumnDef="{{ field }}"
    >
      <ng-container>
        <th
          cdk-header-cell
          class="header-cell"
          mat-sort-header
          *cdkHeaderCellDef
          matTooltip="Sort by {{ field }}"
        >
          <div style="display: grid">
            <div style="min-width: 0">
              <div class="cell header-cell--text">
                {{ field | caseSplit }}
              </div>
            </div>
          </div>
        </th></ng-container
      >
      <ng-container>
        <td cdk-cell #cell class="table-cell" *cdkCellDef="let row">
          <span *ngIf="field === (dataSource.displayedHeaders | async)[0]">
            <button
              class="button"
              class="chevron-button--desktop"
              mat-icon-button
            >
              <mat-icon svgIcon="chevron_right"></mat-icon></button
          ></span>
          <span class="cell data-cell--text">{{ row[field] }}</span>
        </td></ng-container
      >
    </ng-container>
    <ng-template *ngIf="selectedRow">
      <ng-container cdkColumnDef="expandedDetail">
        <div *cdkCellDef="let row">
          <elder-expanded-element
            *ngIf="row === selectedRow"
            [expansionData]="row"
          ></elder-expanded-element>
        </div>
      </ng-container>

      <tr cdk-row *cdkRowDef="let row; columns: ['expandedDetail']"></tr>
    </ng-template>

    <ng-container cdkColumnDef="groupHeader">
      <thead>
        <th
          class="table-cell header group-toggle"
          [attr.colspan]="(dataSource.displayedHeaders | async).length"
          cdk-cell
          *cdkCellDef="let row"
          [class.open]="row.expanded"
        >
          <span class="hh-flex v-center-items">
            <mat-icon
              class="chevron special-row"
              svgIcon="chevron_right"
              rotateIcon
              [class.rotated]="row.expanded"
            ></mat-icon>

            <span class="subheader">
              {{ groupProperty | caseSplit }}: {{ row.term | titlecase }}</span
            >
          </span>
        </th>
      </thead>
    </ng-container>

    <!-- <ng-container cdkColumnDef="mobileColumns">
      <td
        class="mobile-cell hh-grid"
        cdk-cell
        *cdkCellDef="let row"
        [attr.colspan]="columnSpan"
      >
        <button class="mobile-cell--expansion-button hh-span-1" mat-icon-button>
          <mat-icon
            [@rotateChevron]="row == expandedElement ? 'expanded' : 'collapsed'"
            class="chevron-button--rotate"
            style="will-change: transform"
            svgIcon="chevron_right"
          ></mat-icon>
        </button>
        <div class="hh-grid grid-spacing hh-span-11">
          <ng-container
            class="mobile-field--title"
            *ngFor="let field of (dataSource.displayedHeaders | async)"
          >
            <span class="mobile-field--title hh-span-4"
              ><b>{{ field | caseSplit }}</b></span
            >
            <span class="mobile-field--content hh-span-8">{{
              row[field]
            }}</span>
          </ng-container>
        </div>
      </td>
    </ng-container>-->
  </table>
</div>
