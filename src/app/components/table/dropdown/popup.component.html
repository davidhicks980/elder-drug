<button
  #trigger
  (click)="togglePopup()"
  role="listbox"
  [class.active]="attached | async"
  class="popup-trigger"
  name="popup-trigger"
  [matTooltip]="tooltipText"
  matRipple
  matRippleColor="rgba(150,160,180, 0.1)"
>
  <mat-icon class="popup-trigger__icon" svgIcon="{{ icon }}"></mat-icon>
  <span class="popup-trigger__label"><ng-content select="popup-label"></ng-content></span>
</button>

<div #anchor></div>
<ng-template id="anchor" #templatePortalContent>
  <div
    [@transformMenu]="(attached$ | async) ? 'enter' : 'void'"
    cdkTrapFocus
    cdkTrapFocusAutoCapture
    class="panel__container"
  >
    <button (click)="togglePopup(false)" mat-icon-button class="panel__close-button">
      <mat-icon svgIcon="x"></mat-icon>
    </button>
    <ng-container [ngTemplateOutlet]="content.templateRef"></ng-container>
  </div>
</ng-template>
